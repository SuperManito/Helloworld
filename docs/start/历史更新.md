# 更新日志

- ## 2022-02-23（最新） <!-- {docsify-ignore} -->

> 1. 控制面板新增短信验证码登录获取Cookie插件
> 2. 控制面板新增环境变量配置文件页语法检测，如若存在语法错误将会保存失败并输出报错内容
> 3. 控制面板修复编辑器的代码语法颜色，现在代码颜色会根据语法实时变动
> 4. 控制面板 OpenApi 新增账号删除、查询账号总数内置接口，修改添加账号内置接口的返回内容，新增支持用户自定义接口
> 5. 调整项目主命令中的修改环境变量快捷命令用法，如若未检测到环境变量会自动执行添加操作
> 6. 调整项目主命令中的新增环境变量快捷命令用法，如若未定义备注内容则会自动添加备注内容为时间戳
> 7. 调整自动互助功能支持的账号数量上限为55个（原45）
> 8. 优化导入定时算法
> 9. 配置文件修改部分注释内容
> 10. 修复了一些bug

- ## 2022-02-12 <!-- {docsify-ignore} -->

> 1. 调整项目主命令执行脚本 --proxy 下载代理扩展参数，由之前的公共或用户代理改为固定的 jsDelivr，并且仅适用于托管在 GitHub 上的脚本
> 2. 更新 WSKEY 转换 CK 算法至最新APP版本10.4.0
> 3. 调整项目结构，不再内置 Scripts 主要仓库，不再提供用于拉取 GitHub 仓库的公共代理，详细内容请查看通知
> 4. 新增 Own 扩展仓库脚本重复定时任务自动禁用功能，该功能仅在拉库或有新脚本导入时实现，详见配置文件环境变量
> 5. 新增推送通知屏蔽功能，详见配置文件环境变量
> 6. 开放允许用户自定义推送通知模块（sendNotify.js），详见配置文件环境变量
> 7. 调整容器启动时的初始化流程，容器启动时不再更新脚本，仅更新源码
> 8. 调整 TG Bot 的安装方式，由之前的拉库改为离线安装
> 9. 调整配置文件排版，修改部分注释内容
> 10. 修复了一些bug

- ## 2022-01-20 <!-- {docsify-ignore} -->

> 1. 项目主命令新增账号分组执行脚本参数 --grouping，每组账号单独运行一次脚本，参数后面需跟账号序号并分组，参数用法跟指定账号一样，组与组之间用 "@" 隔开
> 2. 为指定账号参数和上述账号分组参数新增用法，可以用 "%" 表示账号总数
> 3. 修改环境变量快捷命令适配修改参数值 task env edit \<变量名称\> \<变量的值\> \<备注\>，可以省略备注参数即不修改备注内容
> 4. 静默运行执行脚本参数参数适配新的 WxPusher 变量
> 5. 更换 Github 默认公共代理，同时新增 GITHUB_PROXY 部署容器环境变量用于指定自定义代理
> 6. 配置文件新增部分变量并修改了部分注释内容，删除了一些无效变量
> 7. 修复了一些bug

- ## 2022-01-15 <!-- {docsify-ignore} -->

> 1. 新增主要/扩展仓库脚本新增定时任务自动禁用功能，详见配置文件变量
> 2. 终止执行由原来的交互确认改为等待3秒后执行终止操作
> 3. 优化全部执行，适配静默通知参数
> 4. 新增 WxPusher 推送通知方式

- ## 2022-01-09 <!-- {docsify-ignore} -->

> 1. 新增自定义推送通知消息功能 task notify \<tittle\> \<content\>
> 2. 修复了添加扩展仓库、扩展脚本命令修改配置文件注释变量的bug

- ## 2022-01-05 <!-- {docsify-ignore} -->

> 1. 格式化列出项目相关命令的输出内容，使内容变得更加工整增强可读性
> 2. 移除了使用WSKEY更新账号后的账号有效性检测，只输出更新结果
> 3. 为新增环境变量快捷命令适配添加备注，task env add <变量名> <变量值> <备注>，仍可按照之前的用法使用即省略备注参数
> 4. 调整了控制面板快速执行页的快捷按钮，新增两个常用命令
> 5. 修复了一些bug

- ## 2022-01-03 <!-- {docsify-ignore} -->

> 1. 项目主命令新增可选参数 --wait 等待执行，用于等待指定时间后再执行任务，参数后面需要跟时间值，具体值参照sleep命令的用法，支持毫秒
> 2. 项目主命令可选参数 --delay 延迟执行已取消整点不生效的机制，调整该机制仅适用于定时任务
> 3. 控制面板登录页表单UI调整
> 4. 优化定时算法和可选参数判断

- ## 2021-12-31 <!-- {docsify-ignore} -->

> 1. 官网上线
> 2. 新增添加 Own 扩展仓库功能 task repo \<url\> \<branch\> \<path\>
> 3. 新增添加 Raw 扩展脚本功能 task raw \<url\>
> 4. 控制面板已换装了全新的简约背景
> 5. 控制面板代码编辑器行高调整到了150%，不再显得紧凑
> 6. 控制面板日志页新增刷新按钮，方便查看正在运行中的脚本
> 7. 项目主命令新增静默执行 --mute 可选命令参数，用于控制在执行脚本后不推送消息通知
> 8. 查看本地脚本清单新增扩展用法 task list \<path\>，用于列出指定目录下的脚本
> 9. 适配检查指定账号是否有效 task cookie check \<num\>，已为整个账号操作命令应用了指定账号的扩展用法
> 10. 为扩展脚本（OwnRawFile）适配地址自动纠正功能，目前地址纠正功能已应用到了整个项目
> 11. 调整电报机器人服务，每次启动/重启都会推送上线提醒
> 12. 开放修改推送通知尾内容，详见配置文件中的变量
> 13. 配置文件重新排版，修改了部分注释内容和区域划分
> 14. 项目内各功能的下载脚本超时时间改为20秒，原10秒
> 15. 修复了一些bug

- ## 2021-12-20 <!-- {docsify-ignore} -->

> 1. 控制面板UI细节调整
> 2. 全部执行脚本范围新增匹配scripts目录下的第三方脚本
> 3. 修复了一些bug

- ## 2021-12-16 <!-- {docsify-ignore} -->

> 1. 项目主命令新增可选参数 --background 用于后台运行脚本
> 2. 控制面板配置文件页新增代码检测机制，如果有语法错误会提示保存失败
> 3. 优化了项目命令的输出内容
> 4. 降低了检测ck是否有效相关命令的频率，减少出现API请求失败的情况
> 5. 配置文件更新
> 6. 修复了一些bug

- ## 2021-11-24 <!-- {docsify-ignore} -->

> 1. 底层代码重构并整合了一些用于执行脚本相关的命令，详细使用方法详见使用说明文档
> 2. 执行脚本指定账号参数（原指定执行）新增支持指定多个账号，同时新增支持账号区间
> 3. 控制面板代码编辑器UI调整，去除行号边栏背景，同时增大行号边栏与内容之间的间距，新增光标所在行行号高亮
> 4. 控制面板新增代码编辑器右侧小地图预览
> 5. 控制面板新增全新UI设计的 搜索/替换 框，可通过 Ctrl+F 键调出
> 6. 控制面板文件树调整UI，现在展开箭头位于文件名或目录名的左侧
> 7. 控制面板为一些页面添加了代码颜色匹配
> 8. 控制面板对比工具页优化排版，适配浅色主题
> 9. 控制面板调整了网页共享终端的UI
> 10. 控制面板使用说明页重新排版，新增快速访问目录
> 11. 控制面板更新CK接口Token cookieApiToken 现更名为 openApiToken ，修改密码之后会重置该值
> 12. 控制面板接口命名规则整理，新增OpenAPI开放CK和WSKEY更新接口，分别是 /openApi/updateCookie 和  /openApi/addOrUpdateAccount ，可做相关自定义对接
> 13. 优化容器定时，减少出现Crond进程被杀的情况
> 14. 查看进程命令 (task ps) 新增统计显示配置文件、日志、所有脚本仓库的占用空间
> 15. 执行位于远程仓库的脚本（原远程执行）新增地址纠正功能，自动转换为raw原始文件链接
> 16. 优化终止执行命令，新增交互确认
> 17. 新增 ENABLE_SCRIPTS_PROXY 部署容器全局环境变量，用于控制Scripts主库是否使用代理
> 18. 推送通知备注remarks功能新增支持数组，优化了推送脚本
> 19. 配置文件新增部分变量，修改了部分注释内容
> 20. 修复了一些bug

- ## 2021-10-30 <!-- {docsify-ignore} -->

> 1. 升级了 WSKEY 转换脚本，采用最新京东APP版本(10.2.2)算法，支持自定义设备信息
> 2. 控制面板新增 UrlEncode编码/UrlDecode解码 工具，位于账号配置页上方Button
> 3. 单独更新新增子命令 update \<path\> ，更新指定路径下的仓库
> 4. 后台挂机功能去除挂机活动脚本(热气球)
> 5. 一些优化

- ## 2021-10-16 <!-- {docsify-ignore} -->

> 1. 新增清理进程功能 task cleanup ，检测并终止卡死的脚本进程以此释放内存占用，默认杀死距离启动超过6个小时的卡死进程，可通过可选参数 \<hours\> 指定此时间
> 2. 单独更新 update \<cmd\> 新增子命令，更新所有仓库 repo、更新 "Raw" 脚本 raw
> 3. 区分了 own 脚本两种拉取方式的定时控制变量，已在配置文件新增相关变量
> 4. 导出互助码脚本新增导出用于提交到 bot 的互助码格式，可自行定义导出的账号排序，已在配置文件新增相关变量
> 5. 项目主命令新增适配执行 Shell 类型的脚本
> 6. 优化更新账号命令，新增更新异常提示，调整更新后检测ck机制仅检测更新成功后的ck
> 7. 优化管理全局环境变量的修改子命令，现在支持修改包含各种符号的变量值
> 8. 优化终止执行命令，现在只终止对应进程不再终止其它包含对应关键字符串的脚本进程
> 9. 删除日志功能 task rmlog 新增参数 \<days\> 可以直接指定删除天数
> 10. 导出互助码脚本新增导出京喜财富岛互助码变量
> 11. 控制面板查阅脚本页新增在线编辑功能，可以通过面板直接编辑脚本
> 12. 控制面板修复浅色主题下js文件显示不清楚的bug
> 13. 控制面板新增支持使用同一个浏览器同时登录多个容器
> 14. 更新使用教程
> 15. 修复了一些bug

- ## 2021-10-06 <!-- {docsify-ignore} -->

> 1. 新增管理全局环境变量功能 ( task env \<cmd\> )，默认交互，添加 add、删除 del、修改 edit、查询 search，支持快捷命令
> 2. 限制了导出互助码脚本生成的助力码组合数量，原因是根据用户反馈账号太多会报错
> 3. 脚本清单中未查询到的脚本名现在标记为 \<未知\>
> 4. 优化更新账号命令，仅检测更新成功后的ck
> 5. 优化单独更新命令和后台挂机功能
> 6. 面板UI细节调整
> 7. 配置文件更改部分变量和备注内容

- ## 2021-09-25 <!-- {docsify-ignore} -->

> 1. 面板性能优化，解决了查看长日志卡顿的问题
> 2. 优化更新账号命令，现在没有配置wskey的账号更新后不再检测CK是否有效并推送通知，可自由添加其它账号的通知备注

- ## 2021-09-22 <!-- {docsify-ignore} -->

> 1. 优化面板登录，现在登录后有效期为24小时，同时解决了在部分情况下面板更新后掉登录的问题
> 2. 配置文件修改了部分推送通知类和项目功能类环境变量
> 3. 全部执行新增在选择脚本范围后列出脚本和脚本名
> 4. 优化更新账号命令，现在支持将acconut.json中的元素压缩为一行
> 5. 更新账号后的备注时间精确到秒

- ## 2021-09-18 <!-- {docsify-ignore} -->

> 1. 更新账号命令 (task cookie update) 已重做，新增更新后检测是否有效，优化了执行逻辑
> 2. 新增指定账号更新 task cookie update \<num\>
> 3. 配置文件修正了部分注释内容
> 4. 控制面板快速执行页的本地脚本清单现在可以实时输出日志
> 5. 修复了在部分情况下预装环境报错的问题，原因是安装 jsdom 模块需要Python环境，已调整相关安装顺序
> 6. 更改了网页终端服务的端口号，方便容器在 host 网络类型下使用，以解决部分软路由环境下该功能的默认端口已被占用的情况

- ## 2021-09-15 <!-- {docsify-ignore} -->

> 1. 新增全局代理功能，支持在执行js脚本时使用代理，最近发现部分脚本出现IP被拉黑的情况，可以尝试此功能
> 2. 配置文件新增 "定义远程执行下载脚本并执行完毕后是否删除（选填）" 和 "定义执行脚本时是否启用代理（选填）" 项目功能类环境变量
> 3. 优化了配置文件传参并适配执行指定路径的脚本，这个变动具体指的是类似临时屏蔽账号那样的case语句，现在仅需填写去掉后缀格式的脚本名
> 4. 适配Bot的bean主命令即统计所有账户的收支情况 ( jcsv )，重启bot后生效
> 5. 其它细节性优化和调整

- ## 2021-09-11 <!-- {docsify-ignore} -->

> 1. 全部执行 ( source runall )功能重做，由之前默认的依次执行改为交互式手动选择执行方式，还可以选择脚本范围
> 2. 配置文件去除了无用变量，修正了部分注释内容
> 3. 优化更新账号功能，控制面板账号配置页加入了wskey格式检测
> 4. 修复了控制面板快速执行页own仓库脚本不能实时输出日志的问题
> 5. 优化控制面板登录信息检测，加快了登录速度
> 6. 单独更新 ( update \<cmd\> ) 新增子命令，更新自定义脚本 extra
> 7. 适配新版本用于拉取第三方脚本的自定义脚本模板 ( sample/extra.sample.sh )
> 8. 更新使用教程文档以及其它细节性优化

- ## 2021-09-09 <!-- {docsify-ignore} -->

> 1. 并发执行不再等待任务执行完毕，另外新增适配记录错误日志
> 2. 在脚本日志中加入了执行时间标记
> 3. 配置文件新增 "定义更新账号成功后是否发送推送通知（选填）" 项目功能类环境变量
> 4. 更新账号 ( task cookie update ) 新增支持推送通知提醒
> 5. 修复了一些bug

- ## 2021-09-08 <!-- {docsify-ignore} -->

> 1. 新增支持自由添加own仓库的脚本定时，新加了一层检测用户own定时的结构体系，现在用户添加的own仓库脚本定时不会被自动化程序删除
> 2. 修复了终止执行 pkill
> 3. 控制面板快速执行页新增适配并发执行
> 4. 控制面板快速执行页新增适配own仓库脚本
> 5. 控制面板查阅脚本页新增支持查看own仓库的脚本

- ## 2021-09-07 <!-- {docsify-ignore} -->

> 1. 查看本地脚本清单 ( task list ) 功能的 “查看own仓库脚本” 已重做，现在将完整显示对应仓库的所有脚本，优化了识别算法脚本中只要有定义就能识别到
> 2. 修复了迅速执行的并发模式

- ## 2021-09-06 <!-- {docsify-ignore} -->

> 1. 重做了执行指定路径的脚本，之前的逻辑有点问题，现在不仅能够正确识别输入的绝对路径或相对路径，还支持输入 ../ 上级目录
> 2. 修复了执行脚本时报错模块找不到的问题，现在将使用全局安装的模块执行非 Scripts 目录的脚本，已推送新的镜像
> 3. 安装环境命令改为根据处理器位数判断是否附带安装，该命令现变更为全局安装部分常用模块，以此适配执行非 Scripts 目录的脚本
> 4. 网页终端ttyd增大了2号字体
> 1. 控制面板新增异常登录告警，当失败次数超过30将禁止登录
> 2. 解决了控制面板在部分网路较差的环境下登录卡动画的问题，出现该问题的原因可能是无法解析当期登录IP的信息，已加入超时机制

- ## 2021-09-05 <!-- {docsify-ignore} -->

> 1. 更改了own仓库raw导入方式二的检测定时算法
> 2. 配置文件新增 "定义是否屏蔽其他开发者仓库指定脚本的定时任务（选填）" 项目功能类环境变量，支持自由屏蔽own仓库脚本的定时任务
> 3. 修正了新的默认仓库的 "京喜财富岛热气球间隔时间" 控制脚本功能类环境变量名称

- ## 2021-09-04 <!-- {docsify-ignore} -->

> 1. 优化了指定路径执行，现在能更好的匹配脚本的路径
> 2. 优化了后台挂机功能的检测机制
> 3. 控制面板去除解析不了的颜色标记
> 4. 修复每次更新后执行 raw 脚本时重复安装模块的问题

- ## 2021-09-03 <!-- {docsify-ignore} -->

> 项目成立